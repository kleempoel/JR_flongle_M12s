data=unique(read.table('blast/jr_flongle_m12s_blast_mito.txt',sep = '\t'))
accessions=data %>% group_by(sacc) %>% summarise(count=n()) %>% arrange(-count)
library(tidyverse)
accessions=data %>% group_by(sacc) %>% summarise(count=n()) %>% arrange(-count)
colnames(data)=c('seqid', 'sseqid', 'sacc', 'staxids', 'evalue', 'pident', 'nident', 'slen', 'qstart', 'qend', 'length', 'mismatch')
accessions=data %>% group_by(sacc) %>% summarise(count=n()) %>% arrange(-count)
library(taxize)
accessions$taxid=NA;accessions$common_name=NA;accessions$scientific_name=NA
accessions$Genus=NA;accessions$Family=NA;accessions$Order=NA;
accessions$Class=NA;accessions$Kingdom=NA;accessions$ref_name=NA;
for (iseq in 1:nrow(accessions)){
temptax=genbank2uid(id = accessions$sacc[iseq])
accessions$taxid[iseq]=as.numeric(unlist(temptax[[1]])[1])
temptax2=unlist(id2name(accessions$taxid[iseq], db = "ncbi"))
accessions$scientific_name[iseq]=temptax2[2]
t2=tax_name(query = c(accessions$scientific_name[iseq]),
get = c("Genus","Family","Order","Class",'Kingdom'), db = "ncbi")
t=unlist(sci2comm(scinames=accessions$scientific_name[iseq], db = "ncbi"))
if(is_empty(t)==F){
accessions$common_name[iseq]=unlist(sci2comm(scinames=accessions$scientific_name[iseq], db = "ncbi"))
}
accessions$Genus[iseq]=t2$Genus
accessions$Family[iseq]=t2$Family
accessions$Order[iseq]=t2$Order
accessions$Class[iseq]=t2$Class
accessions$Kingdom[iseq]=t2$Kingdom
accessions$ref_name[iseq]=attr(temptax[[1]],"name")
rm(temptax,temptax2,t2)
}
print(which(is.na(accessions$Class)==T))
write_csv(accessions, 'blast/jr_flongle_m12s_blast_mito_accessions.csv', na = "NA")
View(accessions)
library(tidyverse)
data=unique(read.table('blast/jr_flongle_m12s_blast_mito.txt',sep = '\t'))
colnames(data)=c('seqid', 'sseqid', 'sacc', 'staxids', 'evalue', 'pident', 'nident', 'slen', 'qstart', 'qend', 'length', 'mismatch')
accessions=data %>% group_by(sacc) %>% summarise(count=n()) %>% arrange(-count)
library(taxize)
accessions$taxid=NA;accessions$common_name=NA;accessions$scientific_name=NA
accessions$Genus=NA;accessions$Family=NA;accessions$Order=NA;
accessions$Class=NA;accessions$Kingdom=NA;accessions$ref_name=NA;
for (iseq in 1:nrow(accessions)){
temptax=genbank2uid(id = accessions$sacc[iseq])
accessions$taxid[iseq]=as.numeric(unlist(temptax[[1]])[1])
temptax2=unlist(id2name(accessions$taxid[iseq], db = "ncbi"))
accessions$scientific_name[iseq]=temptax2[2]
t2=tax_name(query = c(accessions$scientific_name[iseq]),
get = c("Genus","Family","Order","Class",'Kingdom'), db = "ncbi")
t=unlist(sci2comm(scinames=accessions$scientific_name[iseq], db = "ncbi"))
if(is_empty(t)==F){
accessions$common_name[iseq]=unlist(sci2comm(scinames=accessions$scientific_name[iseq], db = "ncbi"))
}
accessions$Genus[iseq]=t2$Genus
accessions$Family[iseq]=t2$Family
accessions$Order[iseq]=t2$Order
accessions$Class[iseq]=t2$Class
accessions$Kingdom[iseq]=t2$Kingdom
accessions$ref_name[iseq]=attr(temptax[[1]],"name")
rm(temptax,temptax2,t2)
}
print(which(is.na(accessions$Class)==T))
write_csv(accessions, 'blast/jr_flongle_m12s_blast_mito_accessions.csv', na = "NA")
View(accessions)
